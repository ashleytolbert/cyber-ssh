\documentclass[11pt]{article}

\usepackage{hyperref, enumitem, times, microtype}
\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}

\newcommand{\slim}{\vspace{\baselineskip}}

\begin{document}

\noindent \textbf{Title:} Policy-friendly remote access to computer resources: the successor to SSH

\section*{Abstract}

\section{Participants}

\subsection{Stanford Computer Science PIs}

\noindent \textbf{Keith Winstein} is an assistant professor of
computer science and, by courtesy, of law at Stanford. Winstein
created the Mosh (mobile shell) tool and the State Synchronization
Protocol, which is estimated to have more than a million users. He and
his colleagues and students developed the Sprout protocol for mobile
networking, the Remy tool for automated protocol design, the ExCamera
system for massively parallel video encoding on cloud microservices,
and the Lepton system, which has re-compressed hundreds of petabytes
of image files. Winstein has received the Usenix NSDI Community Award
(2017), a Google Faculty Research Award (2017 and 2015), the ACM
SIGCOMM Doctoral Dissertation Award for Outstanding PhD Thesis in
Computer Networking and Data Communication (2015), a Sprowls award for
best thesis in computer science at MIT (2014), and the Applied
Networking Research Prize (2013). Winstein previously served as a
staff reporter at The Wall Street Journal (2007--2010) and consulting
engineer at Dropbox (2014--2017).

\slim

\noindent \textbf{David Mazi\`{e}res} is a professor of computer
science at Stanford University, where he leads the Secure Computer
Systems research group. He also serves as Chief Scientist at Stellar
Development Foundation, and is a founder of Intrinsic,
Inc. Prof.~Mazi\`{e}res's research interests include Operating Systems
and Distributed Systems, with a particular focus on security. Some of
the projects he and his students have worked on include SFS (a
self-certifying network file system), SUNDR (a file system that
introduced the notion of fork linearizability), Kademlia (a widely
used peer-to-peer routing algorithm), Coral (a peer-to-peer content
distribution network), HiStar (a secure operating system based on
decentralized information flow control), tcpcrypt (a TCP option
providing forward-secure encryption), Hails (a web framework that can
preserve privacy while incorporating untrusted third-party apps), Dune
(a driver granting linux processes safe access to privileged CPU
features), and COWL (an information-flow-control-based browser
security architecture). Prof.~Mazi\`{e}res has several awards
including an Oakland distinguished paper award (2014), Sloan award
(2002), USENIX best paper award (2001), NSF CAREER award (2001), MIT
Sprowls best thesis in computer science award (2000).

\subsection{SLAC PIs}

\noindent \textbf{Ben Calvert} is the Chief Information Security
Officer (CISO) at SLAC for the Infrastructure and Safety Directorate,
reporting directly to Chief Information Officer. In his role, Ben is
responsible for establishing the information security strategy and
direction for SLAC, overseeing and coordinating all information
security efforts across the laboratory and being accountable and
responsible for lab-wide results. Ben has more than 14+ years of
global experience at Fortune 500 companies in the areas of risk
management, intellectual property and IT performance.

\slim

\noindent \textbf{Erwin Lopez} is the Deputy Chief Information
Security Officer (Deputy CISO) at SLAC. He has over 15+ years of IT
experience, specifically focusing on Cyber Security. Erwin came to
SLAC from Lawrence Livermore National Laboratory where he worked for
over 11 years in the Cyber Security program, where he held numerous
technical and leadership positions. Erwin is a proficient IT leader
with a wealth of technical experience in network intrusion analysis,
forensics, malware reversing, cyber incident handling, security
assessments, web application and penetration testing, and application
software development. Erwin has a Bachelor’s degree from California
State University, Chico in Computer Engineering; in addition, he holds
numerous Cyber Security certifications.

\slim

\noindent \textbf{Ashley Tolbert} is a Cyber Security Analyst at SLAC,
focusing on security operations in incident response, forensics
software, and cyber security awareness and training. She has a diverse
background that includes researching cyber security and modeling
software for other research labs such as NASA Ames and ABB Research
Center in Germany. Directly prior to her work at SLAC, Ashley earned a
Master’s of Science in Information Security from Carnegie Mellon
University. She holds a bachelor’s degree from Auburn University,
where she studied software engineering.  \slim

\subsection{Doctoral students}

\noindent \textbf{Dima Kogan} is a doctoral student in computer science,
advised by Profs.~Winstein and Mazi\`{e}res. He was previously a Software
Engineer at Google.

\slim

\noindent \textbf{Riad S.~Wahby} is a doctoral student in computer science,
advised by Profs.~Winstein and Mazi\`{e}res. He was previously a
research scientist in the NYU Computer Science department and a
visiting researcher at the University of Texas at Austin. Before
entering computer-science research, Wahby spent ten years as a Staff
Design Engineer building analog and mixed-signal integrated circuits
at Silicon Labs.

\section{Proposed Research Agenda}

The government~\cite{cyberframework, nistSSH, trumpeo}.


\subsection{Authentication architecture}

We begin by describing the long-term authentication architecture we
envision for a hypothetical SSH version~3, then discuss how an
approximation of this architecture can be shoe-horned into existing
SSH~2 implementations in the nearer term.  An important principle
underlying our authentication architecture is a separation of
server-side authentication mechanisms from the client side
implementation of those mechanisms.

On the server side, authentication takes place by verifying signatures
on messages that identify what is being authenticated as unambiguously
as possible, including at a minimum:
\begin{itemize}\itemsep=0pt
\item The public key of the server,
\item The server's own notion of its human-readable name (which won't
  necessarily be what the user typed, given host aliases),
\item The exact command being executed,
\item A fresh channel identifier derived from a cryptographic hash of
  a server nonce and session keying material, and
\item Bounds on other uses of the channel being authenticated (master
  channel establishment, port forwarding, etc.).
\end{itemize}

On the client side, the agent protocol must be amenable to numerous
implementations, including a standard agent process, an agent process
combined with a hardware token, and, importantly, an agent process
spread across two or more machines.  The latter architecture is
particularly important for users who wish to maintain a central log of
authentication requests.

As an example, consider a user whose agent process signs requests in
conjunction with a secure server.  The secure server has necessarily
but not sufficient privileges to authenticate the user.  If the user
believes her office was physically breached before her screen locked,
she cannot trust any local logs or process.  However, so long as the
remote server is not compromised, she can examine the remote server
logs to discover exactly what commands the intruder authorized on what
servers.  With visibility across all of a user's different
authentication requests, an authentication server can run anomaly
detection and potentially require step-up authentication following
unusual activity.

Using pro-active key sharing, it is even be possible for the user to
recover from such a compromise without changing her public key
everywhere, simply by refreshing the key sharing between her client
and the server.  That said, we will likely require servers to support
``multi-key'' setups where an authentication request must be signed by
multiple keys, because threshold cryptography is not always convenient
to retrofit to hardware tokens.

Another important aspect of the client-side authentication
architecture is that clients must know exactly where authentication
requests originate.  This requires a way of attenuating the privileges
of a channel to the authentication server when an agent connection is
forwarded across machines, by recursively annotating authentication
requests as they are forwarded back to the agent.

\subsubsection{Retrofitting improved authentication to SSH~2}

To get a feel for the deployability of our authentication
architecture, we will retrofit an approximation of the architecture to
SSH~2.  This will require a significant re-write of \texttt{ssh-agent}
and minor modifications to \texttt{ssh} (the client), but can be done
with no chances to \texttt{sshd} on the server side.

The main idea is that when the \texttt{ssh} client connects to a
server, rather than initiate the connection itself, it will act as a
dumb packet relay so that the \texttt{ssh-agent} is actually the
program establishing the connection.  \texttt{ssh-agent} will drive
the protocol until it has committed to the command being executed on
the server.  At that point, there will be a logical connection between
the agent and the server relayed by the \texttt{ssh} client that
cannot read the messages because it doesn't have the session key.  The
agent can then initiate a rekey request so as to hand the logical
connection endpoint off to the \texttt{ssh} client.

\section{Timeline}

This proposal is for a one-year pilot project while the PIs work to
raise money to support a longer-term effort.

\section{Publication Plan}

\section{Budget}

We are asking for support for one Ph.D.~student (Greg Hill), plus
\$20,000 in equipment to build and deploy twenty measurement/antidote
boxes. CHAI has agreed to fund Greg Hill's travel to its sites in
Africa. Year 1 of the pilot project will cost \$97,825 out of gift
funds.

\slim

\noindent Annual budget:

\slim

\noindent \begin{tabular}{ll|l}
& \bf Amount & \bf \$ \\
Student & Academic-year 50\% RA & \$29,163 \\
        & Summer 90\% RA & \$19,442 \\

Tuition & Academic-year & \$19,094 \\
        & Summer        & \$1,909 \\

Benefits & Student & \$2,527 \\

Equipment &         & \$20,000 \\

\hline

Facility fee & 8\% & \$5,690 \\
Annual total & & \$97,825 \\

\end{tabular}

\slim

The Cyber Initiative previously funded part of the development of the
``self-incentivizing networks'' concept that is one of the mechanisms
we intend to deploy in the field (June 2015 funding round, \$30,000).

{\footnotesize

\bibliographystyle{abbrv}
\bibliography{cyber}
}

\end{document}
